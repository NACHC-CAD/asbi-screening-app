{
   "library" : {
      "annotation" : [ {
         "translatorOptions" : "",
         "type" : "CqlToElmInfo"
      } ],
      "identifier" : {
         "id" : "WhoAuditLogicLibrary",
         "version" : "2.0.0"
      },
      "schemaIdentifier" : {
         "id" : "urn:hl7-org:elm",
         "version" : "r1"
      },
      "usings" : {
         "def" : [ {
            "localIdentifier" : "System",
            "uri" : "urn:hl7-org:elm-types:r1"
         }, {
            "localIdentifier" : "FHIR",
            "uri" : "http://hl7.org/fhir",
            "version" : "4.0.1"
         } ]
      },
      "includes" : {
         "def" : [ {
            "localIdentifier" : "FHIRHelpers",
            "path" : "FHIRHelpers",
            "version" : "4.0.1"
         } ]
      },
      "parameters" : {
         "def" : [ {
            "name" : "DisplayScreeningScores",
            "accessLevel" : "Public",
            "default" : {
               "valueType" : "{urn:hl7-org:elm-types:r1}Boolean",
               "value" : "true",
               "type" : "Literal"
            }
         }, {
            "name" : "QuestionnaireURL",
            "accessLevel" : "Public",
            "default" : {
               "valueType" : "{urn:hl7-org:elm-types:r1}String",
               "value" : "http://www.cdc.gov/ncbddd/fasd/audit",
               "type" : "Literal"
            }
         } ]
      },
      "codeSystems" : {
         "def" : [ {
            "name" : "LOINC",
            "id" : "http://loinc.org",
            "accessLevel" : "Public"
         }, {
            "name" : "SNOMED-CT",
            "id" : "http://snomed.info/sct",
            "accessLevel" : "Public"
         }, {
            "name" : "FHIR Condition Clinical Status",
            "id" : "http://terminology.hl7.org/CodeSystem/condition-clinical",
            "accessLevel" : "Public"
         }, {
            "name" : "FHIR Condition Verification Status",
            "id" : "http://terminology.hl7.org/CodeSystem/condition-ver-status",
            "accessLevel" : "Public"
         }, {
            "name" : "ADMINISTRATIVE GENDER",
            "id" : "http://terminology.hl7.org/CodeSystem/v3-AdministrativeGender",
            "accessLevel" : "Public"
         }, {
            "name" : "NULL FLAVOR",
            "id" : "http://terminology.hl7.org/CodeSystem/v3-NullFlavor",
            "accessLevel" : "Public"
         }, {
            "name" : "LOCAL",
            "id" : "http://www.cdc.gov/ncbddd/fasd",
            "accessLevel" : "Public"
         } ]
      },
      "valueSets" : {
         "def" : [ {
            "name" : "Pregnancy",
            "id" : "2.16.840.1.113883.3.526.3.378",
            "accessLevel" : "Public"
         }, {
            "name" : "Pregnancy (New ICD10 codes published in 2018 and 2019)",
            "id" : "2.16.840.1.113762.1.4.1032.80",
            "accessLevel" : "Public"
         }, {
            "name" : "AUD (i.e., Alcohol Use Disorder)",
            "id" : "2.16.840.1.113762.1.4.1032.129",
            "accessLevel" : "Public"
         }, {
            "name" : "Hysterectomy",
            "id" : "2.16.840.1.113762.1.4.1032.148",
            "accessLevel" : "Public"
         } ]
      },
      "codes" : {
         "def" : [ {
            "name" : "Pregnancy status code",
            "id" : "82810-3",
            "display" : "Pregnancy status",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Pregnant code",
            "id" : "77386006",
            "display" : "Patient currently pregnant (finding)",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "SNOMED-CT"
            }
         }, {
            "name" : "Confirmed verification status code",
            "id" : "confirmed",
            "display" : "Confirmed",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Verification Status"
            }
         }, {
            "name" : "Active clinical status code",
            "id" : "active",
            "display" : "Active",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Recurrence clinical status code",
            "id" : "recurrence",
            "display" : "Recurrence",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Relapse clinical status code",
            "id" : "relapse",
            "display" : "Relapse",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Inactive clinical status code",
            "id" : "inactive",
            "display" : "Inactive",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Remission clinical status code",
            "id" : "remission",
            "display" : "Remission",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Resolved clinical status code",
            "id" : "resolved",
            "display" : "Resolved",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "FHIR Condition Clinical Status"
            }
         }, {
            "name" : "Male administrative gender code",
            "id" : "M",
            "display" : "Male",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "ADMINISTRATIVE GENDER"
            }
         }, {
            "name" : "Female administrative gender code",
            "id" : "F",
            "display" : "Female",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "ADMINISTRATIVE GENDER"
            }
         }, {
            "name" : "Unknown value code",
            "id" : "UNK",
            "display" : "Unknown",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "NULL FLAVOR"
            }
         }, {
            "name" : "WHO AUDIT-C Total Score code",
            "id" : "75626-2",
            "display" : "WHO AUDIT-C Total Score",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "WHO AUDIT Total Score code",
            "id" : "75624-7",
            "display" : "WHO AUDIT Total Score",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "Sex assigned at birth",
            "id" : "76689-9",
            "display" : "Sex assigned at birth",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOINC"
            }
         }, {
            "name" : "USAUDIT-C Total Score code",
            "id" : "UACS",
            "display" : "USAUDIT-C Total Score",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "USAUDIT Total Score code",
            "id" : "UAFS",
            "display" : "USAUDIT Total Score",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Yes",
            "id" : "yes",
            "display" : "Yes",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "No",
            "id" : "no",
            "display" : "No",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         }, {
            "name" : "Never",
            "id" : "never",
            "display" : "Never",
            "accessLevel" : "Public",
            "codeSystem" : {
               "name" : "LOCAL"
            }
         } ]
      },
      "concepts" : {
         "def" : [ {
            "name" : "Pregnancy status",
            "display" : "Pregnancy status",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pregnancy status code"
            } ]
         }, {
            "name" : "Pregnant",
            "display" : "Patient currently pregnant (finding)",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Pregnant code"
            } ]
         }, {
            "name" : "Condition Confirmed",
            "display" : "Confirmed",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Confirmed verification status code"
            } ]
         }, {
            "name" : "Condition Active",
            "display" : "Active",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Active clinical status code"
            } ]
         }, {
            "name" : "Condition Recurrence",
            "display" : "Recurrence",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Recurrence clinical status code"
            } ]
         }, {
            "name" : "Condition Relapse",
            "display" : "Relapse",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Relapse clinical status code"
            } ]
         }, {
            "name" : "Condition Inactive",
            "display" : "Inactive",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Inactive clinical status code"
            } ]
         }, {
            "name" : "Condition Remission",
            "display" : "Remission",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Remission clinical status code"
            } ]
         }, {
            "name" : "Condition Resolved",
            "display" : "Resolved",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "Resolved clinical status code"
            } ]
         }, {
            "name" : "Alcohol screening codes",
            "display" : "Alcohol screening codes",
            "accessLevel" : "Public",
            "code" : [ {
               "name" : "WHO AUDIT-C Total Score code"
            }, {
               "name" : "WHO AUDIT Total Score code"
            }, {
               "name" : "USAUDIT-C Total Score code"
            }, {
               "name" : "USAUDIT Total Score code"
            } ]
         } ]
      },
      "contexts" : {
         "def" : [ {
            "name" : "Patient"
         } ]
      },
      "statements" : {
         "def" : [ {
            "name" : "Patient",
            "context" : "Patient",
            "expression" : {
               "type" : "SingletonFrom",
               "operand" : {
                  "dataType" : "{http://hl7.org/fhir}Patient",
                  "templateId" : "http://hl7.org/fhir/StructureDefinition/Patient",
                  "type" : "Retrieve"
               }
            }
         }, {
            "name" : "CurrentQuestionnaireURL",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "name" : "QuestionnaireURL",
               "type" : "ParameterRef"
            }
         }, {
            "name" : "SexAtBirthExtension",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "SingletonFrom",
               "operand" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "Ext",
                     "expression" : {
                        "path" : "extension",
                        "type" : "Property",
                        "source" : {
                           "name" : "Patient",
                           "type" : "ExpressionRef"
                        }
                     }
                  } ],
                  "relationship" : [ ],
                  "where" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "ToString",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "url",
                           "scope" : "Ext",
                           "type" : "Property"
                        } ]
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex",
                        "type" : "Literal"
                     } ]
                  }
               }
            }
         }, {
            "name" : "SexAtBirthObservation",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "S",
                  "expression" : {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "templateId" : "http://hl7.org/fhir/StructureDefinition/Observation",
                     "codeProperty" : "code",
                     "codeComparator" : "~",
                     "type" : "Retrieve",
                     "codes" : {
                        "type" : "ToList",
                        "operand" : {
                           "name" : "Sex assigned at birth",
                           "type" : "CodeRef"
                        }
                     }
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "In",
                  "operand" : [ {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "status",
                        "scope" : "S",
                        "type" : "Property"
                     }
                  }, {
                     "type" : "List",
                     "element" : [ {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "final",
                        "type" : "Literal"
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "corrected",
                        "type" : "Literal"
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "amended",
                        "type" : "Literal"
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "SexAtBirth",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "name" : "SexAtBirthExtension",
                        "type" : "ExpressionRef"
                     }
                  }
               },
               "then" : {
                  "path" : "value",
                  "type" : "Property",
                  "source" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "SexAtBirthExtension",
                        "type" : "ExpressionRef"
                     }
                  }
               },
               "else" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "If",
                     "condition" : {
                        "type" : "Exists",
                        "operand" : {
                           "name" : "SexAtBirthObservation",
                           "type" : "ExpressionRef"
                        }
                     },
                     "then" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "type" : "Coalesce",
                              "operand" : [ {
                                 "type" : "Flatten",
                                 "operand" : {
                                    "type" : "Query",
                                    "source" : [ {
                                       "alias" : "$this",
                                       "expression" : {
                                          "type" : "Query",
                                          "source" : [ {
                                             "alias" : "$this",
                                             "expression" : {
                                                "name" : "SexAtBirthObservation",
                                                "type" : "ExpressionRef"
                                             }
                                          } ],
                                          "where" : {
                                             "type" : "Not",
                                             "operand" : {
                                                "type" : "IsNull",
                                                "operand" : {
                                                   "path" : "value",
                                                   "type" : "Property",
                                                   "source" : {
                                                      "name" : "$this",
                                                      "type" : "AliasRef"
                                                   }
                                                }
                                             }
                                          },
                                          "return" : {
                                             "distinct" : false,
                                             "expression" : {
                                                "path" : "value",
                                                "type" : "Property",
                                                "source" : {
                                                   "name" : "$this",
                                                   "type" : "AliasRef"
                                                }
                                             }
                                          }
                                       }
                                    } ],
                                    "where" : {
                                       "type" : "Not",
                                       "operand" : {
                                          "type" : "IsNull",
                                          "operand" : {
                                             "path" : "coding",
                                             "type" : "Property",
                                             "source" : {
                                                "name" : "$this",
                                                "type" : "AliasRef"
                                             }
                                          }
                                       }
                                    },
                                    "return" : {
                                       "distinct" : false,
                                       "expression" : {
                                          "path" : "coding",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 }
                              } ]
                           }
                        }
                     },
                     "else" : {
                        "path" : "code",
                        "type" : "Property",
                        "source" : {
                           "name" : "Unknown value code",
                           "type" : "CodeRef"
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "type" : "ChoiceTypeSpecifier",
                     "choice" : [ {
                        "name" : "{urn:hl7-org:elm-types:r1}Boolean",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}Time",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}DateTime",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}CodeableConcept",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}Quantity",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}Range",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}Reference",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}Integer",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}decimal",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{http://hl7.org/fhir}string",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}Date",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }, {
                        "name" : "{urn:hl7-org:elm-types:r1}Decimal",
                        "type" : "NamedTypeSpecifier"
                     } ]
                  }
               }
            }
         }, {
            "name" : "MaleAtBirth",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Equal",
               "operand" : [ {
                  "asType" : "{urn:hl7-org:elm-types:r1}String",
                  "type" : "As",
                  "operand" : {
                     "name" : "SexAtBirth",
                     "type" : "ExpressionRef"
                  }
               }, {
                  "path" : "code",
                  "type" : "Property",
                  "source" : {
                     "name" : "Male administrative gender code",
                     "type" : "CodeRef"
                  }
               } ]
            }
         }, {
            "name" : "FemaleAtBirth",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Equal",
               "operand" : [ {
                  "asType" : "{urn:hl7-org:elm-types:r1}String",
                  "type" : "As",
                  "operand" : {
                     "name" : "SexAtBirth",
                     "type" : "ExpressionRef"
                  }
               }, {
                  "path" : "code",
                  "type" : "Property",
                  "source" : {
                     "name" : "Female administrative gender code",
                     "type" : "CodeRef"
                  }
               } ]
            }
         }, {
            "name" : "SexAtBirthUnknown",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Equal",
                  "operand" : [ {
                     "asType" : "{urn:hl7-org:elm-types:r1}String",
                     "type" : "As",
                     "operand" : {
                        "name" : "SexAtBirth",
                        "type" : "ExpressionRef"
                     }
                  }, {
                     "path" : "code",
                     "type" : "Property",
                     "source" : {
                        "name" : "Unknown value code",
                        "type" : "CodeRef"
                     }
                  } ]
               }, {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "MaleAtBirth",
                        "type" : "ExpressionRef"
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}Boolean",
                        "value" : "false",
                        "type" : "Literal"
                     } ]
                  }, {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "FemaleAtBirth",
                        "type" : "ExpressionRef"
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}Boolean",
                        "value" : "false",
                        "type" : "Literal"
                     } ]
                  } ]
               } ]
            }
         }, {
            "name" : "ToCode",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "name" : "ToCode",
               "libraryName" : "FHIRHelpers",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "coding",
                  "type" : "OperandRef"
               } ]
            },
            "operand" : [ {
               "name" : "coding",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Coding",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "ToConcept",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "name" : "ToConcept",
               "libraryName" : "FHIRHelpers",
               "type" : "FunctionRef",
               "operand" : [ {
                  "name" : "concept",
                  "type" : "OperandRef"
               } ]
            },
            "operand" : [ {
               "name" : "concept",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}CodeableConcept",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "PeriodToInterval",
            "context" : "Patient",
            "accessLevel" : "Public",
            "type" : "FunctionDef",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "IsNull",
                  "operand" : {
                     "name" : "period",
                     "type" : "OperandRef"
                  }
               },
               "then" : {
                  "type" : "As",
                  "operand" : {
                     "type" : "Null"
                  },
                  "asTypeSpecifier" : {
                     "type" : "IntervalTypeSpecifier",
                     "pointType" : {
                        "name" : "{urn:hl7-org:elm-types:r1}DateTime",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "lowClosed" : true,
                  "highClosed" : true,
                  "type" : "Interval",
                  "low" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "start",
                        "type" : "Property",
                        "source" : {
                           "name" : "period",
                           "type" : "OperandRef"
                        }
                     }
                  },
                  "high" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "end",
                        "type" : "Property",
                        "source" : {
                           "name" : "period",
                           "type" : "OperandRef"
                        }
                     }
                  }
               }
            },
            "operand" : [ {
               "name" : "period",
               "operandTypeSpecifier" : {
                  "name" : "{http://hl7.org/fhir}Period",
                  "type" : "NamedTypeSpecifier"
               }
            } ]
         }, {
            "name" : "IsIncluded",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "GreaterOrEqual",
               "operand" : [ {
                  "precision" : "Year",
                  "type" : "CalculateAge",
                  "operand" : {
                     "path" : "birthDate.value",
                     "type" : "Property",
                     "source" : {
                        "name" : "Patient",
                        "type" : "ExpressionRef"
                     }
                  }
               }, {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "18",
                  "type" : "Literal"
               } ]
            }
         }, {
            "name" : "PregnancyObservations",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "P",
                  "expression" : {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "templateId" : "http://hl7.org/fhir/StructureDefinition/Observation",
                     "codeProperty" : "code",
                     "codeComparator" : "~",
                     "type" : "Retrieve",
                     "codes" : {
                        "path" : "codes",
                        "type" : "Property",
                        "source" : {
                           "name" : "Pregnancy status",
                           "type" : "ConceptRef"
                        }
                     }
                  }
               } ],
               "let" : [ {
                  "identifier" : "lookback",
                  "expression" : {
                     "lowClosed" : true,
                     "highClosed" : true,
                     "type" : "Interval",
                     "low" : {
                        "type" : "Subtract",
                        "operand" : [ {
                           "type" : "Now"
                        }, {
                           "value" : 42,
                           "unit" : "weeks",
                           "type" : "Quantity"
                        } ]
                     },
                     "high" : {
                        "type" : "Now"
                     }
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "In",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "strict" : false,
                                 "type" : "As",
                                 "operand" : {
                                    "path" : "effective",
                                    "scope" : "P",
                                    "type" : "Property"
                                 },
                                 "asTypeSpecifier" : {
                                    "name" : "{http://hl7.org/fhir}dateTime",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              }
                           }, {
                              "name" : "lookback",
                              "type" : "QueryLetRef"
                           } ]
                        }, {
                           "type" : "In",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "issued",
                                 "scope" : "P",
                                 "type" : "Property"
                              }
                           }, {
                              "name" : "lookback",
                              "type" : "QueryLetRef"
                           } ]
                        } ]
                     }, {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "strict" : false,
                              "type" : "As",
                              "operand" : {
                                 "path" : "value",
                                 "scope" : "P",
                                 "type" : "Property"
                              },
                              "asTypeSpecifier" : {
                                 "name" : "{http://hl7.org/fhir}CodeableConcept",
                                 "type" : "NamedTypeSpecifier"
                              }
                           } ]
                        }, {
                           "name" : "Pregnant",
                           "type" : "ConceptRef"
                        } ]
                     } ]
                  }, {
                     "type" : "In",
                     "operand" : [ {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "status",
                           "scope" : "P",
                           "type" : "Property"
                        }
                     }, {
                        "type" : "List",
                        "element" : [ {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "final",
                           "type" : "Literal"
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "corrected",
                           "type" : "Literal"
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "amended",
                           "type" : "Literal"
                        } ]
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "PregnancyConditions",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "C",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "dataType" : "{http://hl7.org/fhir}Condition",
                        "templateId" : "http://hl7.org/fhir/StructureDefinition/Condition",
                        "codeProperty" : "code",
                        "codeComparator" : "in",
                        "type" : "Retrieve",
                        "codes" : {
                           "name" : "Pregnancy",
                           "type" : "ValueSetRef"
                        }
                     }, {
                        "dataType" : "{http://hl7.org/fhir}Condition",
                        "templateId" : "http://hl7.org/fhir/StructureDefinition/Condition",
                        "codeProperty" : "code",
                        "codeComparator" : "in",
                        "type" : "Retrieve",
                        "codes" : {
                           "name" : "Pregnancy (New ICD10 codes published in 2018 and 2019)",
                           "type" : "ValueSetRef"
                        }
                     } ]
                  }
               } ],
               "let" : [ {
                  "identifier" : "lookback",
                  "expression" : {
                     "lowClosed" : true,
                     "highClosed" : true,
                     "type" : "Interval",
                     "low" : {
                        "type" : "Subtract",
                        "operand" : [ {
                           "type" : "Now"
                        }, {
                           "value" : 42,
                           "unit" : "weeks",
                           "type" : "Quantity"
                        } ]
                     },
                     "high" : {
                        "type" : "Now"
                     }
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Or",
                           "operand" : [ {
                              "type" : "In",
                              "operand" : [ {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "onset",
                                       "scope" : "C",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}dateTime",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 }
                              }, {
                                 "name" : "lookback",
                                 "type" : "QueryLetRef"
                              } ]
                           }, {
                              "type" : "Overlaps",
                              "operand" : [ {
                                 "name" : "PeriodToInterval",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "onset",
                                       "scope" : "C",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}Period",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 } ]
                              }, {
                                 "name" : "lookback",
                                 "type" : "QueryLetRef"
                              } ]
                           } ]
                        }, {
                           "type" : "In",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "recordedDate",
                                 "scope" : "C",
                                 "type" : "Property"
                              }
                           }, {
                              "name" : "lookback",
                              "type" : "QueryLetRef"
                           } ]
                        } ]
                     }, {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "clinicalStatus",
                                 "scope" : "C",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "Condition Active",
                              "type" : "ConceptRef"
                           } ]
                        }, {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "clinicalStatus",
                                 "scope" : "C",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "Condition Recurrence",
                              "type" : "ConceptRef"
                           } ]
                        } ]
                     } ]
                  }, {
                     "type" : "Equivalent",
                     "operand" : [ {
                        "name" : "ToConcept",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "verificationStatus",
                           "scope" : "C",
                           "type" : "Property"
                        } ]
                     }, {
                        "name" : "Condition Confirmed",
                        "type" : "ConceptRef"
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "IsPregnant",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "PregnancyObservations",
                     "type" : "ExpressionRef"
                  }
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "PregnancyConditions",
                     "type" : "ExpressionRef"
                  }
               } ]
            }
         }, {
            "name" : "SortedPregnancyObservationDates",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "P",
                  "expression" : {
                     "name" : "PregnancyObservations",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "date",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "strict" : false,
                                 "type" : "As",
                                 "operand" : {
                                    "path" : "effective",
                                    "scope" : "P",
                                    "type" : "Property"
                                 },
                                 "asTypeSpecifier" : {
                                    "name" : "{http://hl7.org/fhir}dateTime",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "strict" : false,
                                 "type" : "As",
                                 "operand" : {
                                    "path" : "effective",
                                    "scope" : "P",
                                    "type" : "Property"
                                 },
                                 "asTypeSpecifier" : {
                                    "name" : "{http://hl7.org/fhir}instant",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "end",
                                 "type" : "Property",
                                 "source" : {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "effective",
                                       "scope" : "P",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}Period",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "start",
                                 "type" : "Property",
                                 "source" : {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "effective",
                                       "scope" : "P",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}Period",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "issued",
                                 "scope" : "P",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "SortedPregnancyConditionDates",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "C",
                  "expression" : {
                     "name" : "PregnancyConditions",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "date",
                        "value" : {
                           "type" : "Coalesce",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "strict" : false,
                                 "type" : "As",
                                 "operand" : {
                                    "path" : "onset",
                                    "scope" : "C",
                                    "type" : "Property"
                                 },
                                 "asTypeSpecifier" : {
                                    "name" : "{http://hl7.org/fhir}dateTime",
                                    "type" : "NamedTypeSpecifier"
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "end",
                                 "type" : "Property",
                                 "source" : {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "onset",
                                       "scope" : "C",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}Period",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "start",
                                 "type" : "Property",
                                 "source" : {
                                    "strict" : false,
                                    "type" : "As",
                                    "operand" : {
                                       "path" : "onset",
                                       "scope" : "C",
                                       "type" : "Property"
                                    },
                                    "asTypeSpecifier" : {
                                       "name" : "{http://hl7.org/fhir}Period",
                                       "type" : "NamedTypeSpecifier"
                                    }
                                 }
                              }
                           }, {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "recordedDate",
                                 "scope" : "C",
                                 "type" : "Property"
                              }
                           } ]
                        }
                     } ]
                  }
               },
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "SortedPregnacyDates",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "D",
                  "expression" : {
                     "type" : "Union",
                     "operand" : [ {
                        "name" : "SortedPregnancyObservationDates",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "SortedPregnancyConditionDates",
                        "type" : "ExpressionRef"
                     } ]
                  }
               } ],
               "relationship" : [ ],
               "sort" : {
                  "by" : [ {
                     "direction" : "desc",
                     "path" : "date",
                     "type" : "ByColumn"
                  } ]
               }
            }
         }, {
            "name" : "MostRecentPregnancyDate",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "path" : "date",
               "type" : "Property",
               "source" : {
                  "type" : "First",
                  "source" : {
                     "name" : "SortedPregnacyDates",
                     "type" : "ExpressionRef"
                  }
               }
            }
         }, {
            "name" : "RecentAlcoholScreeningLookbackStart",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "name" : "IsPregnant",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "ToDateTime",
                  "operand" : {
                     "type" : "Subtract",
                     "operand" : [ {
                        "type" : "Today"
                     }, {
                        "value" : 1,
                        "unit" : "year",
                        "type" : "Quantity"
                     } ]
                  }
               },
               "else" : {
                  "type" : "If",
                  "condition" : {
                     "type" : "Greater",
                     "operand" : [ {
                        "name" : "MostRecentPregnancyDate",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "ToDateTime",
                        "operand" : {
                           "type" : "Subtract",
                           "operand" : [ {
                              "type" : "Today"
                           }, {
                              "value" : 3,
                              "unit" : "months",
                              "type" : "Quantity"
                           } ]
                        }
                     } ]
                  },
                  "then" : {
                     "name" : "MostRecentPregnancyDate",
                     "type" : "ExpressionRef"
                  },
                  "else" : {
                     "type" : "ToDateTime",
                     "operand" : {
                        "type" : "Subtract",
                        "operand" : [ {
                           "type" : "Today"
                        }, {
                           "value" : 3,
                           "unit" : "months",
                           "type" : "Quantity"
                        } ]
                     }
                  }
               }
            }
         }, {
            "name" : "PreviouslyCompletedQuestionnaireResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "QR",
                  "expression" : {
                     "dataType" : "{http://hl7.org/fhir}QuestionnaireResponse",
                     "templateId" : "http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse",
                     "type" : "Retrieve"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "Equal",
                              "operand" : [ {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "questionnaire",
                                    "scope" : "QR",
                                    "type" : "Property"
                                 }
                              }, {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                 "value" : "http://www.cdc.gov/ncbddd/fasd/usaudit",
                                 "type" : "Literal"
                              } ]
                           }, {
                              "type" : "And",
                              "operand" : [ {
                                 "type" : "GreaterOrEqual",
                                 "operand" : [ {
                                    "type" : "ToDateTime",
                                    "operand" : {
                                       "type" : "DateFrom",
                                       "operand" : {
                                          "path" : "value",
                                          "type" : "Property",
                                          "source" : {
                                             "path" : "authored",
                                             "scope" : "QR",
                                             "type" : "Property"
                                          }
                                       }
                                    }
                                 }, {
                                    "name" : "RecentAlcoholScreeningLookbackStart",
                                    "type" : "ExpressionRef"
                                 } ]
                              }, {
                                 "type" : "LessOrEqual",
                                 "operand" : [ {
                                    "type" : "DateFrom",
                                    "operand" : {
                                       "path" : "value",
                                       "type" : "Property",
                                       "source" : {
                                          "path" : "authored",
                                          "scope" : "QR",
                                          "type" : "Property"
                                       }
                                    }
                                 }, {
                                    "type" : "Today"
                                 } ]
                              } ]
                           } ]
                        }, {
                           "type" : "Equal",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "status",
                                 "scope" : "QR",
                                 "type" : "Property"
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}String",
                              "value" : "completed",
                              "type" : "Literal"
                           } ]
                        } ]
                     }, {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "Equal",
                              "operand" : [ {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "questionnaire",
                                    "scope" : "QR",
                                    "type" : "Property"
                                 }
                              }, {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}String",
                                 "value" : "http://www.cdc.gov/ncbddd/fasd/audit",
                                 "type" : "Literal"
                              } ]
                           }, {
                              "type" : "And",
                              "operand" : [ {
                                 "type" : "GreaterOrEqual",
                                 "operand" : [ {
                                    "type" : "ToDateTime",
                                    "operand" : {
                                       "type" : "DateFrom",
                                       "operand" : {
                                          "path" : "value",
                                          "type" : "Property",
                                          "source" : {
                                             "path" : "authored",
                                             "scope" : "QR",
                                             "type" : "Property"
                                          }
                                       }
                                    }
                                 }, {
                                    "name" : "RecentAlcoholScreeningLookbackStart",
                                    "type" : "ExpressionRef"
                                 } ]
                              }, {
                                 "type" : "LessOrEqual",
                                 "operand" : [ {
                                    "type" : "DateFrom",
                                    "operand" : {
                                       "path" : "value",
                                       "type" : "Property",
                                       "source" : {
                                          "path" : "authored",
                                          "scope" : "QR",
                                          "type" : "Property"
                                       }
                                    }
                                 }, {
                                    "type" : "Today"
                                 } ]
                              } ]
                           } ]
                        }, {
                           "type" : "Equal",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "status",
                                 "scope" : "QR",
                                 "type" : "Property"
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}String",
                              "value" : "completed",
                              "type" : "Literal"
                           } ]
                        } ]
                     } ]
                  }, {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "Equal",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "questionnaire",
                                 "scope" : "QR",
                                 "type" : "Property"
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}String",
                              "value" : "http://www.cdc.gov/ncbddd/fasd/nidaqs2usaudit",
                              "type" : "Literal"
                           } ]
                        }, {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "GreaterOrEqual",
                              "operand" : [ {
                                 "type" : "ToDateTime",
                                 "operand" : {
                                    "type" : "DateFrom",
                                    "operand" : {
                                       "path" : "value",
                                       "type" : "Property",
                                       "source" : {
                                          "path" : "authored",
                                          "scope" : "QR",
                                          "type" : "Property"
                                       }
                                    }
                                 }
                              }, {
                                 "name" : "RecentAlcoholScreeningLookbackStart",
                                 "type" : "ExpressionRef"
                              } ]
                           }, {
                              "type" : "LessOrEqual",
                              "operand" : [ {
                                 "type" : "DateFrom",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "path" : "authored",
                                       "scope" : "QR",
                                       "type" : "Property"
                                    }
                                 }
                              }, {
                                 "type" : "Today"
                              } ]
                           } ]
                        } ]
                     }, {
                        "type" : "Equal",
                        "operand" : [ {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "QR",
                              "type" : "Property"
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "completed",
                           "type" : "Literal"
                        } ]
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "PreviouslyCompletedResponseItems",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "QR",
                  "expression" : {
                     "name" : "PreviouslyCompletedQuestionnaireResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "item",
                     "scope" : "QR",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "PreviouslyCompletedResponseValues",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "T",
                  "expression" : {
                     "type" : "Flatten",
                     "operand" : {
                        "name" : "PreviouslyCompletedResponseItems",
                        "type" : "ExpressionRef"
                     }
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "id",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "linkId",
                              "scope" : "T",
                              "type" : "Property"
                           }
                        }
                     }, {
                        "name" : "answer",
                        "value" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "type" : "Query",
                              "source" : [ {
                                 "alias" : "$this",
                                 "expression" : {
                                    "path" : "answer",
                                    "scope" : "T",
                                    "type" : "Property"
                                 }
                              } ],
                              "where" : {
                                 "type" : "Not",
                                 "operand" : {
                                    "type" : "IsNull",
                                    "operand" : {
                                       "path" : "value",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              },
                              "return" : {
                                 "distinct" : false,
                                 "expression" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     } ]
                  }
               }
            }
         }, {
            "name" : "RecentScoreUsAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "usauditc-score",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "answer",
                        "scope" : "RV",
                        "type" : "Property"
                     }
                  }
               }
            }
         }, {
            "name" : "HasRecentScoreUsAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentScoreUsAuditC",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "RecentScoreFullUsAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "usaudit-score",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "answer",
                        "scope" : "RV",
                        "type" : "Property"
                     }
                  }
               }
            }
         }, {
            "name" : "HasRecentScoreFullUsAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentScoreFullUsAudit",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "RecentScoreAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "auditc-score",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "answer",
                        "scope" : "RV",
                        "type" : "Property"
                     }
                  }
               }
            }
         }, {
            "name" : "HasRecentScoreAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentScoreAuditC",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "RecentScoreFullAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-score",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "answer",
                        "scope" : "RV",
                        "type" : "Property"
                     }
                  }
               }
            }
         }, {
            "name" : "HasRecentScoreFullAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentScoreFullAudit",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "RecentApsResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "prescreen-question",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "RV",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "RecentApsYesResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "RecentApsResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equivalent",
                  "operand" : [ {
                     "name" : "ToCode",
                     "libraryName" : "FHIRHelpers",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "asType" : "{http://hl7.org/fhir}Coding",
                        "type" : "As",
                        "operand" : {
                           "name" : "R",
                           "type" : "AliasRef"
                        }
                     } ]
                  }, {
                     "name" : "Yes",
                     "type" : "CodeRef"
                  } ]
               }
            }
         }, {
            "name" : "RecentApsNoResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "RecentApsResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equivalent",
                  "operand" : [ {
                     "name" : "ToCode",
                     "libraryName" : "FHIRHelpers",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "asType" : "{http://hl7.org/fhir}Coding",
                        "type" : "As",
                        "operand" : {
                           "name" : "R",
                           "type" : "AliasRef"
                        }
                     } ]
                  }, {
                     "name" : "No",
                     "type" : "CodeRef"
                  } ]
               }
            }
         }, {
            "name" : "HasRecentYesApsResponse",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentApsYesResponses",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "HasRecentNoApsResponse",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentApsNoResponses",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "RecentUsauditQuestionOneResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "usaudit-question-one",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "RV",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "RecentAuditQuestionOneResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "RV",
                  "expression" : {
                     "name" : "PreviouslyCompletedResponseValues",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "RV",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-one",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "RV",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "HasRecentNeverResponseUsauditQuestionOne",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "In",
               "operand" : [ {
                  "name" : "Never",
                  "type" : "CodeRef"
               }, {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "X",
                     "expression" : {
                        "name" : "RecentUsauditQuestionOneResponses",
                        "type" : "ExpressionRef"
                     }
                  } ],
                  "return" : {
                     "distinct" : false,
                     "expression" : {
                        "name" : "ToCode",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "asType" : "{http://hl7.org/fhir}Coding",
                           "type" : "As",
                           "operand" : {
                              "name" : "X",
                              "type" : "AliasRef"
                           }
                        } ]
                     }
                  }
               } ]
            }
         }, {
            "name" : "HasRecentNeverResponseAuditQuestionOne",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "In",
               "operand" : [ {
                  "name" : "Never",
                  "type" : "CodeRef"
               }, {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "X",
                     "expression" : {
                        "name" : "RecentAuditQuestionOneResponses",
                        "type" : "ExpressionRef"
                     }
                  } ],
                  "return" : {
                     "distinct" : false,
                     "expression" : {
                        "name" : "ToCode",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "asType" : "{http://hl7.org/fhir}Coding",
                           "type" : "As",
                           "operand" : {
                              "name" : "X",
                              "type" : "AliasRef"
                           }
                        } ]
                     }
                  }
               } ]
            }
         }, {
            "name" : "RecentAlcoholScreeningObservations",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "O",
                  "expression" : {
                     "dataType" : "{http://hl7.org/fhir}Observation",
                     "templateId" : "http://hl7.org/fhir/StructureDefinition/Observation",
                     "codeProperty" : "code",
                     "codeComparator" : "~",
                     "type" : "Retrieve",
                     "codes" : {
                        "path" : "codes",
                        "type" : "Property",
                        "source" : {
                           "name" : "Alcohol screening codes",
                           "type" : "ConceptRef"
                        }
                     }
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "GreaterOrEqual",
                           "operand" : [ {
                              "type" : "ToDateTime",
                              "operand" : {
                                 "type" : "DateFrom",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "path" : "effective",
                                       "scope" : "O",
                                       "type" : "Property"
                                    }
                                 }
                              }
                           }, {
                              "name" : "RecentAlcoholScreeningLookbackStart",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "type" : "LessOrEqual",
                           "operand" : [ {
                              "type" : "DateFrom",
                              "operand" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "effective",
                                    "scope" : "O",
                                    "type" : "Property"
                                 }
                              }
                           }, {
                              "type" : "Today"
                           } ]
                        } ]
                     }, {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "GreaterOrEqual",
                           "operand" : [ {
                              "type" : "ToDateTime",
                              "operand" : {
                                 "type" : "DateFrom",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "path" : "issued",
                                       "scope" : "O",
                                       "type" : "Property"
                                    }
                                 }
                              }
                           }, {
                              "name" : "RecentAlcoholScreeningLookbackStart",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "type" : "LessOrEqual",
                           "operand" : [ {
                              "type" : "DateFrom",
                              "operand" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "issued",
                                    "scope" : "O",
                                    "type" : "Property"
                                 }
                              }
                           }, {
                              "type" : "Today"
                           } ]
                        } ]
                     } ]
                  }, {
                     "type" : "In",
                     "operand" : [ {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "status",
                           "scope" : "O",
                           "type" : "Property"
                        }
                     }, {
                        "type" : "List",
                        "element" : [ {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "final",
                           "type" : "Literal"
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "corrected",
                           "type" : "Literal"
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "amended",
                           "type" : "Literal"
                        } ]
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "HasRecentAlcoholScreeningObservations",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "RecentAlcoholScreeningObservations",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "HasEvidenceOfRecentAlcoholScreening",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Or",
                           "operand" : [ {
                              "type" : "Or",
                              "operand" : [ {
                                 "name" : "HasRecentScoreUsAuditC",
                                 "type" : "ExpressionRef"
                              }, {
                                 "name" : "HasRecentScoreFullUsAudit",
                                 "type" : "ExpressionRef"
                              } ]
                           }, {
                              "name" : "HasRecentScoreAuditC",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "name" : "HasRecentScoreFullAudit",
                           "type" : "ExpressionRef"
                        } ]
                     }, {
                        "name" : "HasRecentNoApsResponse",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "type" : "And",
                     "operand" : [ {
                        "name" : "HasRecentYesApsResponse",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Or",
                        "operand" : [ {
                           "name" : "HasRecentNeverResponseUsauditQuestionOne",
                           "type" : "ExpressionRef"
                        }, {
                           "name" : "HasRecentNeverResponseAuditQuestionOne",
                           "type" : "ExpressionRef"
                        } ]
                     } ]
                  } ]
               }, {
                  "name" : "HasRecentAlcoholScreeningObservations",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "AlcoholUseDisorders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "dataType" : "{http://hl7.org/fhir}Condition",
               "templateId" : "http://hl7.org/fhir/StructureDefinition/Condition",
               "codeProperty" : "code",
               "codeComparator" : "in",
               "type" : "Retrieve",
               "codes" : {
                  "name" : "AUD (i.e., Alcohol Use Disorder)",
                  "type" : "ValueSetRef"
               }
            }
         }, {
            "name" : "ActiveAlcoholUseDisorders",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "A",
                  "expression" : {
                     "name" : "AlcoholUseDisorders",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "clinicalStatus",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "Condition Active",
                              "type" : "ConceptRef"
                           } ]
                        }, {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "clinicalStatus",
                                 "scope" : "A",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "Condition Recurrence",
                              "type" : "ConceptRef"
                           } ]
                        } ]
                     }, {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToConcept",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "path" : "clinicalStatus",
                              "scope" : "A",
                              "type" : "Property"
                           } ]
                        }, {
                           "name" : "Condition Relapse",
                           "type" : "ConceptRef"
                        } ]
                     } ]
                  }, {
                     "type" : "Equivalent",
                     "operand" : [ {
                        "name" : "ToConcept",
                        "libraryName" : "FHIRHelpers",
                        "type" : "FunctionRef",
                        "operand" : [ {
                           "path" : "verificationStatus",
                           "scope" : "A",
                           "type" : "Property"
                        } ]
                     }, {
                        "name" : "Condition Confirmed",
                        "type" : "ConceptRef"
                     } ]
                  } ]
               }
            }
         }, {
            "name" : "HasAlcoholUseDisorder",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Exists",
               "operand" : {
                  "name" : "ActiveAlcoholUseDisorders",
                  "type" : "ExpressionRef"
               }
            }
         }, {
            "name" : "Excluded",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "name" : "HasEvidenceOfRecentAlcoholScreening",
                  "type" : "ExpressionRef"
               }, {
                  "name" : "HasAlcoholUseDisorder",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "ApplyScreeningInstrument",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "name" : "IsIncluded",
                  "type" : "ExpressionRef"
               }, {
                  "type" : "Not",
                  "operand" : {
                     "name" : "Excluded",
                     "type" : "ExpressionRef"
                  }
               } ]
            }
         }, {
            "name" : "HasHadHysterectomy",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "Exists",
                  "operand" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "P",
                        "expression" : {
                           "dataType" : "{http://hl7.org/fhir}Procedure",
                           "templateId" : "http://hl7.org/fhir/StructureDefinition/Procedure",
                           "codeProperty" : "code",
                           "codeComparator" : "in",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Hysterectomy",
                              "type" : "ValueSetRef"
                           }
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "Equal",
                        "operand" : [ {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "P",
                              "type" : "Property"
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "completed",
                           "type" : "Literal"
                        } ]
                     }
                  }
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "C",
                        "expression" : {
                           "dataType" : "{http://hl7.org/fhir}Condition",
                           "templateId" : "http://hl7.org/fhir/StructureDefinition/Condition",
                           "codeProperty" : "code",
                           "codeComparator" : "in",
                           "type" : "Retrieve",
                           "codes" : {
                              "name" : "Hysterectomy",
                              "type" : "ValueSetRef"
                           }
                        }
                     } ],
                     "relationship" : [ ],
                     "where" : {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "Or",
                           "operand" : [ {
                              "type" : "Equivalent",
                              "operand" : [ {
                                 "name" : "ToConcept",
                                 "libraryName" : "FHIRHelpers",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "path" : "clinicalStatus",
                                    "scope" : "C",
                                    "type" : "Property"
                                 } ]
                              }, {
                                 "name" : "Condition Active",
                                 "type" : "ConceptRef"
                              } ]
                           }, {
                              "type" : "Equivalent",
                              "operand" : [ {
                                 "name" : "ToConcept",
                                 "libraryName" : "FHIRHelpers",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "path" : "clinicalStatus",
                                    "scope" : "C",
                                    "type" : "Property"
                                 } ]
                              }, {
                                 "name" : "Condition Recurrence",
                                 "type" : "ConceptRef"
                              } ]
                           } ]
                        }, {
                           "type" : "Equivalent",
                           "operand" : [ {
                              "name" : "ToConcept",
                              "libraryName" : "FHIRHelpers",
                              "type" : "FunctionRef",
                              "operand" : [ {
                                 "path" : "verificationStatus",
                                 "scope" : "C",
                                 "type" : "Property"
                              } ]
                           }, {
                              "name" : "Condition Confirmed",
                              "type" : "ConceptRef"
                           } ]
                        } ]
                     }
                  }
               } ]
            }
         }, {
            "name" : "AuditQuestion3Text",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "LessOrEqual",
                     "operand" : [ {
                        "precision" : "Year",
                        "type" : "CalculateAge",
                        "operand" : {
                           "path" : "birthDate.value",
                           "type" : "Property",
                           "source" : {
                              "name" : "Patient",
                              "type" : "ExpressionRef"
                           }
                        }
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                        "value" : "65",
                        "type" : "Literal"
                     } ]
                  }, {
                     "name" : "MaleAtBirth",
                     "type" : "ExpressionRef"
                  } ]
               },
               "then" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}String",
                  "value" : "How often do you have 5 or more drinks on one occasion?",
                  "type" : "Literal"
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}String",
                  "value" : "How often do you have 4 or more drinks on one occasion?",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "NidaQsAlcoholQuestionText",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "LessOrEqual",
                     "operand" : [ {
                        "precision" : "Year",
                        "type" : "CalculateAge",
                        "operand" : {
                           "path" : "birthDate.value",
                           "type" : "Property",
                           "source" : {
                              "name" : "Patient",
                              "type" : "ExpressionRef"
                           }
                        }
                     }, {
                        "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                        "value" : "65",
                        "type" : "Literal"
                     } ]
                  }, {
                     "name" : "MaleAtBirth",
                     "type" : "ExpressionRef"
                  } ]
               },
               "then" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}String",
                  "value" : "In the past year, how often have you had five or more drinks a day?",
                  "type" : "Literal"
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}String",
                  "value" : "In the past year, how often have you had four or more drinks a day?",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditQuestionnaire",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "SingletonFrom",
               "operand" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "Q",
                     "expression" : {
                        "dataType" : "{http://hl7.org/fhir}Questionnaire",
                        "templateId" : "http://hl7.org/fhir/StructureDefinition/Questionnaire",
                        "type" : "Retrieve"
                     }
                  } ],
                  "relationship" : [ ],
                  "where" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "path" : "url",
                           "scope" : "Q",
                           "type" : "Property"
                        }
                     }, {
                        "name" : "CurrentQuestionnaireURL",
                        "type" : "ExpressionRef"
                     } ]
                  }
               }
            }
         }, {
            "name" : "ItemLinkIds",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "Q",
                  "expression" : {
                     "name" : "AuditQuestionnaire",
                     "type" : "ExpressionRef"
                  }
               } ],
               "let" : [ {
                  "identifier" : "item",
                  "expression" : {
                     "path" : "item",
                     "scope" : "Q",
                     "type" : "Property"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "name" : "item",
                                 "type" : "QueryLetRef"
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "linkId",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "linkId",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               }
            }
         }, {
            "name" : "IndexOfQuestion",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Tuple",
               "element" : [ {
                  "name" : "prescreen",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "prescreen-question",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "one",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-one",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "two",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-two",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "three",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-three",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "auditcscore",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "auditc-score",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "four",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-four",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "five",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-five",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "six",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-six",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "seven",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-seven",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "eight",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-eight",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "nine",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-nine",
                        "type" : "Literal"
                     }
                  }
               }, {
                  "name" : "ten",
                  "value" : {
                     "type" : "IndexOf",
                     "source" : {
                        "name" : "ItemLinkIds",
                        "type" : "ExpressionRef"
                     },
                     "element" : {
                        "valueType" : "{urn:hl7-org:elm-types:r1}String",
                        "value" : "audit-question-ten",
                        "type" : "Literal"
                     }
                  }
               } ]
            }
         }, {
            "name" : "CurrentQuestionnaireResponse",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "SingletonFrom",
               "operand" : {
                  "type" : "Query",
                  "source" : [ {
                     "alias" : "QR",
                     "expression" : {
                        "dataType" : "{http://hl7.org/fhir}QuestionnaireResponse",
                        "templateId" : "http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse",
                        "type" : "Retrieve"
                     }
                  } ],
                  "relationship" : [ ],
                  "where" : {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "Equal",
                           "operand" : [ {
                              "path" : "value",
                              "type" : "Property",
                              "source" : {
                                 "path" : "questionnaire",
                                 "scope" : "QR",
                                 "type" : "Property"
                              }
                           }, {
                              "name" : "CurrentQuestionnaireURL",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "type" : "SameAs",
                           "operand" : [ {
                              "type" : "DateFrom",
                              "operand" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "path" : "authored",
                                    "scope" : "QR",
                                    "type" : "Property"
                                 }
                              }
                           }, {
                              "type" : "Today"
                           } ]
                        } ]
                     }, {
                        "type" : "Equal",
                        "operand" : [ {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "status",
                              "scope" : "QR",
                              "type" : "Property"
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}String",
                           "value" : "in-progress",
                           "type" : "Literal"
                        } ]
                     } ]
                  }
               }
            }
         }, {
            "name" : "CurrentResponseItems",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "QR",
                  "expression" : {
                     "name" : "CurrentQuestionnaireResponse",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "path" : "item",
                     "scope" : "QR",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "CurrentResponses",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "I",
                  "expression" : {
                     "name" : "CurrentResponseItems",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "return" : {
                  "expression" : {
                     "type" : "Tuple",
                     "element" : [ {
                        "name" : "id",
                        "value" : {
                           "path" : "value",
                           "type" : "Property",
                           "source" : {
                              "path" : "linkId",
                              "scope" : "I",
                              "type" : "Property"
                           }
                        }
                     }, {
                        "name" : "answer",
                        "value" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "type" : "Query",
                              "source" : [ {
                                 "alias" : "$this",
                                 "expression" : {
                                    "path" : "answer",
                                    "scope" : "I",
                                    "type" : "Property"
                                 }
                              } ],
                              "where" : {
                                 "type" : "Not",
                                 "operand" : {
                                    "type" : "IsNull",
                                    "operand" : {
                                       "path" : "value",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              },
                              "return" : {
                                 "distinct" : false,
                                 "expression" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     } ]
                  }
               }
            }
         }, {
            "name" : "CurrentResponsePrescreen",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "prescreen-question",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion1",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "one",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse1",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-one",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex1",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse1",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion1",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse1",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion1",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex1",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "one",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex1",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion2",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "two",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse2",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-two",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex2",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse2",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion2",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse2",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion2",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex2",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "two",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex2",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion3",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "three",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse3",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-three",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex3",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse3",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion3",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse3",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion3",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex3",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "three",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex3",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "ScoreAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Add",
               "operand" : [ {
                  "type" : "Add",
                  "operand" : [ {
                     "name" : "AuditScoreQuestion1",
                     "type" : "ExpressionRef"
                  }, {
                     "name" : "AuditScoreQuestion2",
                     "type" : "ExpressionRef"
                  } ]
               }, {
                  "name" : "AuditScoreQuestion3",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "AnsweredQuestionsOneThroughThree",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "Exists",
                     "operand" : {
                        "name" : "CurrentResponse1",
                        "type" : "ExpressionRef"
                     }
                  }, {
                     "type" : "Exists",
                     "operand" : {
                        "name" : "CurrentResponse2",
                        "type" : "ExpressionRef"
                     }
                  } ]
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse3",
                     "type" : "ExpressionRef"
                  }
               } ]
            }
         }, {
            "name" : "DisplayScoreAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "name" : "AnsweredQuestionsOneThroughThree",
                  "type" : "ExpressionRef"
               }, {
                  "name" : "DisplayScreeningScores",
                  "type" : "ParameterRef"
               } ]
            }
         }, {
            "name" : "ThresholdAuditC",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "name" : "FemaleAtBirth",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "SexAtBirthUnknown",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "type" : "And",
                     "operand" : [ {
                        "name" : "MaleAtBirth",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Greater",
                        "operand" : [ {
                           "precision" : "Year",
                           "type" : "CalculateAge",
                           "operand" : {
                              "path" : "birthDate.value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Patient",
                                 "type" : "ExpressionRef"
                              }
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "65",
                           "type" : "Literal"
                        } ]
                     } ]
                  } ]
               },
               "then" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "3",
                  "type" : "Literal"
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "4",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "DisplayAuditQuestions4to8",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "GreaterOrEqual",
                     "operand" : [ {
                        "name" : "ScoreAuditC",
                        "type" : "ExpressionRef"
                     }, {
                        "name" : "ThresholdAuditC",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "type" : "Not",
                     "operand" : {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToCode",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "asType" : "{http://hl7.org/fhir}Coding",
                              "type" : "As",
                              "operand" : {
                                 "type" : "SingletonFrom",
                                 "operand" : {
                                    "name" : "CurrentResponse1",
                                    "type" : "ExpressionRef"
                                 }
                              }
                           } ]
                        }, {
                           "name" : "Never",
                           "type" : "CodeRef"
                        } ]
                     }
                  } ]
               }, {
                  "type" : "Equivalent",
                  "operand" : [ {
                     "name" : "ToCode",
                     "libraryName" : "FHIRHelpers",
                     "type" : "FunctionRef",
                     "operand" : [ {
                        "asType" : "{http://hl7.org/fhir}Coding",
                        "type" : "As",
                        "operand" : {
                           "type" : "SingletonFrom",
                           "operand" : {
                              "name" : "CurrentResponsePrescreen",
                              "type" : "ExpressionRef"
                           }
                        }
                     } ]
                  }, {
                     "name" : "Yes",
                     "type" : "CodeRef"
                  } ]
               } ]
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion4",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "four",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse4",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-four",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex4",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse4",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion4",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse4",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion4",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex4",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "four",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex4",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion5",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "five",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse5",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-five",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex5",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse5",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion5",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse5",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion5",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex5",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "five",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex5",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion6",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "six",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse6",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-six",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex6",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse6",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion6",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse6",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion6",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex6",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "six",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex6",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion7",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "seven",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse7",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-seven",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex7",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse7",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion7",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse7",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion7",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex7",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "seven",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex7",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion8",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "eight",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse8",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-eight",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex8",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse8",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion8",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse8",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion8",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex8",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "eight",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex8",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "DisplayAuditQuestions9and10",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Or",
               "operand" : [ {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "Less",
                        "operand" : [ {
                           "name" : "ScoreAuditC",
                           "type" : "ExpressionRef"
                        }, {
                           "name" : "ThresholdAuditC",
                           "type" : "ExpressionRef"
                        } ]
                     }, {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToCode",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "asType" : "{http://hl7.org/fhir}Coding",
                              "type" : "As",
                              "operand" : {
                                 "type" : "SingletonFrom",
                                 "operand" : {
                                    "name" : "CurrentResponsePrescreen",
                                    "type" : "ExpressionRef"
                                 }
                              }
                           } ]
                        }, {
                           "name" : "Yes",
                           "type" : "CodeRef"
                        } ]
                     } ]
                  }, {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "Equivalent",
                        "operand" : [ {
                           "name" : "ToCode",
                           "libraryName" : "FHIRHelpers",
                           "type" : "FunctionRef",
                           "operand" : [ {
                              "asType" : "{http://hl7.org/fhir}Coding",
                              "type" : "As",
                              "operand" : {
                                 "type" : "SingletonFrom",
                                 "operand" : {
                                    "name" : "CurrentResponse1",
                                    "type" : "ExpressionRef"
                                 }
                              }
                           } ]
                        }, {
                           "name" : "Never",
                           "type" : "CodeRef"
                        } ]
                     }, {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "And",
                              "operand" : [ {
                                 "type" : "And",
                                 "operand" : [ {
                                    "type" : "Exists",
                                    "operand" : {
                                       "name" : "CurrentResponse1",
                                       "type" : "ExpressionRef"
                                    }
                                 }, {
                                    "type" : "Exists",
                                    "operand" : {
                                       "name" : "CurrentResponse2",
                                       "type" : "ExpressionRef"
                                    }
                                 } ]
                              }, {
                                 "type" : "Exists",
                                 "operand" : {
                                    "name" : "CurrentResponse3",
                                    "type" : "ExpressionRef"
                                 }
                              } ]
                           }, {
                              "type" : "Equal",
                              "operand" : [ {
                                 "name" : "AuditScoreQuestion2",
                                 "type" : "ExpressionRef"
                              }, {
                                 "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                                 "value" : "0",
                                 "type" : "Literal"
                              } ]
                           } ]
                        }, {
                           "type" : "Equal",
                           "operand" : [ {
                              "name" : "AuditScoreQuestion3",
                              "type" : "ExpressionRef"
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        } ]
                     } ]
                  } ]
               }, {
                  "type" : "And",
                  "operand" : [ {
                     "name" : "DisplayAuditQuestions4to8",
                     "type" : "ExpressionRef"
                  }, {
                     "type" : "Exists",
                     "operand" : {
                        "name" : "CurrentResponse8",
                        "type" : "ExpressionRef"
                     }
                  } ]
               } ]
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion9",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "nine",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse9",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-nine",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex9",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse9",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion9",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse9",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion9",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex9",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "nine",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex9",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AuditAnswerOptionsQuestion10",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "$this",
                  "expression" : {
                     "type" : "Query",
                     "source" : [ {
                        "alias" : "$this",
                        "expression" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "path" : "answerOption",
                                 "type" : "Property",
                                 "source" : {
                                    "type" : "Indexer",
                                    "operand" : [ {
                                       "path" : "item",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "AuditQuestionnaire",
                                          "type" : "ExpressionRef"
                                       }
                                    }, {
                                       "path" : "ten",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "IndexOfQuestion",
                                          "type" : "ExpressionRef"
                                       }
                                    } ]
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     } ],
                     "where" : {
                        "type" : "Not",
                        "operand" : {
                           "type" : "IsNull",
                           "operand" : {
                              "path" : "code",
                              "type" : "Property",
                              "source" : {
                                 "name" : "$this",
                                 "type" : "AliasRef"
                              }
                           }
                        }
                     },
                     "return" : {
                        "distinct" : false,
                        "expression" : {
                           "path" : "code",
                           "type" : "Property",
                           "source" : {
                              "name" : "$this",
                              "type" : "AliasRef"
                           }
                        }
                     }
                  }
               } ],
               "where" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "IsNull",
                     "operand" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "name" : "$this",
                           "type" : "AliasRef"
                        }
                     }
                  }
               },
               "return" : {
                  "distinct" : false,
                  "expression" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "name" : "$this",
                        "type" : "AliasRef"
                     }
                  }
               }
            }
         }, {
            "name" : "CurrentResponse10",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Query",
               "source" : [ {
                  "alias" : "R",
                  "expression" : {
                     "name" : "CurrentResponses",
                     "type" : "ExpressionRef"
                  }
               } ],
               "relationship" : [ ],
               "where" : {
                  "type" : "Equal",
                  "operand" : [ {
                     "path" : "id",
                     "scope" : "R",
                     "type" : "Property"
                  }, {
                     "valueType" : "{urn:hl7-org:elm-types:r1}String",
                     "value" : "audit-question-ten",
                     "type" : "Literal"
                  } ]
               },
               "return" : {
                  "expression" : {
                     "path" : "answer",
                     "scope" : "R",
                     "type" : "Property"
                  }
               }
            }
         }, {
            "name" : "AuditResponseIndex10",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse10",
                     "type" : "ExpressionRef"
                  }
               },
               "then" : {
                  "type" : "IndexOf",
                  "source" : {
                     "name" : "AuditAnswerOptionsQuestion10",
                     "type" : "ExpressionRef"
                  },
                  "element" : {
                     "strict" : false,
                     "type" : "As",
                     "operand" : {
                        "type" : "SingletonFrom",
                        "operand" : {
                           "type" : "Query",
                           "source" : [ {
                              "alias" : "$this",
                              "expression" : {
                                 "type" : "Query",
                                 "source" : [ {
                                    "alias" : "$this",
                                    "expression" : {
                                       "name" : "CurrentResponse10",
                                       "type" : "ExpressionRef"
                                    }
                                 } ],
                                 "where" : {
                                    "type" : "Not",
                                    "operand" : {
                                       "type" : "IsNull",
                                       "operand" : {
                                          "path" : "code",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "$this",
                                             "type" : "AliasRef"
                                          }
                                       }
                                    }
                                 },
                                 "return" : {
                                    "distinct" : false,
                                    "expression" : {
                                       "path" : "code",
                                       "type" : "Property",
                                       "source" : {
                                          "name" : "$this",
                                          "type" : "AliasRef"
                                       }
                                    }
                                 }
                              }
                           } ],
                           "where" : {
                              "type" : "Not",
                              "operand" : {
                                 "type" : "IsNull",
                                 "operand" : {
                                    "path" : "value",
                                    "type" : "Property",
                                    "source" : {
                                       "name" : "$this",
                                       "type" : "AliasRef"
                                    }
                                 }
                              }
                           },
                           "return" : {
                              "distinct" : false,
                              "expression" : {
                                 "path" : "value",
                                 "type" : "Property",
                                 "source" : {
                                    "name" : "$this",
                                    "type" : "AliasRef"
                                 }
                              }
                           }
                        }
                     },
                     "asTypeSpecifier" : {
                        "name" : "{urn:hl7-org:elm-types:r1}String",
                        "type" : "NamedTypeSpecifier"
                     }
                  }
               },
               "else" : {
                  "type" : "Negate",
                  "operand" : {
                     "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                     "value" : "1",
                     "type" : "Literal"
                  }
               }
            }
         }, {
            "name" : "AuditScoreQuestion10",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "If",
               "condition" : {
                  "type" : "Not",
                  "operand" : {
                     "type" : "Equal",
                     "operand" : [ {
                        "name" : "AuditResponseIndex10",
                        "type" : "ExpressionRef"
                     }, {
                        "type" : "Negate",
                        "operand" : {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "1",
                           "type" : "Literal"
                        }
                     } ]
                  }
               },
               "then" : {
                  "strict" : false,
                  "type" : "As",
                  "operand" : {
                     "path" : "value",
                     "type" : "Property",
                     "source" : {
                        "path" : "value",
                        "type" : "Property",
                        "source" : {
                           "type" : "Indexer",
                           "operand" : [ {
                              "path" : "extension",
                              "type" : "Property",
                              "source" : {
                                 "type" : "Indexer",
                                 "operand" : [ {
                                    "path" : "answerOption",
                                    "type" : "Property",
                                    "source" : {
                                       "type" : "Indexer",
                                       "operand" : [ {
                                          "path" : "item",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "AuditQuestionnaire",
                                             "type" : "ExpressionRef"
                                          }
                                       }, {
                                          "path" : "ten",
                                          "type" : "Property",
                                          "source" : {
                                             "name" : "IndexOfQuestion",
                                             "type" : "ExpressionRef"
                                          }
                                       } ]
                                    }
                                 }, {
                                    "name" : "AuditResponseIndex10",
                                    "type" : "ExpressionRef"
                                 } ]
                              }
                           }, {
                              "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                              "value" : "0",
                              "type" : "Literal"
                           } ]
                        }
                     }
                  },
                  "asTypeSpecifier" : {
                     "name" : "{urn:hl7-org:elm-types:r1}Integer",
                     "type" : "NamedTypeSpecifier"
                  }
               },
               "else" : {
                  "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                  "value" : "0",
                  "type" : "Literal"
               }
            }
         }, {
            "name" : "AnsweredQuestionsFourThroughEight",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "Exists",
                           "operand" : {
                              "name" : "CurrentResponse4",
                              "type" : "ExpressionRef"
                           }
                        }, {
                           "type" : "Exists",
                           "operand" : {
                              "name" : "CurrentResponse5",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }, {
                        "type" : "Exists",
                        "operand" : {
                           "name" : "CurrentResponse6",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }, {
                     "type" : "Exists",
                     "operand" : {
                        "name" : "CurrentResponse7",
                        "type" : "ExpressionRef"
                     }
                  } ]
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse8",
                     "type" : "ExpressionRef"
                  }
               } ]
            }
         }, {
            "name" : "AnsweredQuestionsNineAndTen",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse9",
                     "type" : "ExpressionRef"
                  }
               }, {
                  "type" : "Exists",
                  "operand" : {
                     "name" : "CurrentResponse10",
                     "type" : "ExpressionRef"
                  }
               } ]
            }
         }, {
            "name" : "AnsweredQuestionsFourThroughTen",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "name" : "AnsweredQuestionsFourThroughEight",
                  "type" : "ExpressionRef"
               }, {
                  "name" : "AnsweredQuestionsNineAndTen",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "DisplayScoreFullAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "name" : "AnsweredQuestionsFourThroughTen",
                  "type" : "ExpressionRef"
               }, {
                  "name" : "DisplayScreeningScores",
                  "type" : "ParameterRef"
               } ]
            }
         }, {
            "name" : "ScoreFullAudit",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "Add",
               "operand" : [ {
                  "type" : "Add",
                  "operand" : [ {
                     "type" : "Add",
                     "operand" : [ {
                        "type" : "Add",
                        "operand" : [ {
                           "type" : "Add",
                           "operand" : [ {
                              "type" : "Add",
                              "operand" : [ {
                                 "type" : "Add",
                                 "operand" : [ {
                                    "name" : "ScoreAuditC",
                                    "type" : "ExpressionRef"
                                 }, {
                                    "name" : "AuditScoreQuestion4",
                                    "type" : "ExpressionRef"
                                 } ]
                              }, {
                                 "name" : "AuditScoreQuestion5",
                                 "type" : "ExpressionRef"
                              } ]
                           }, {
                              "name" : "AuditScoreQuestion6",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "name" : "AuditScoreQuestion7",
                           "type" : "ExpressionRef"
                        } ]
                     }, {
                        "name" : "AuditScoreQuestion8",
                        "type" : "ExpressionRef"
                     } ]
                  }, {
                     "name" : "AuditScoreQuestion9",
                     "type" : "ExpressionRef"
                  } ]
               }, {
                  "name" : "AuditScoreQuestion10",
                  "type" : "ExpressionRef"
               } ]
            }
         }, {
            "name" : "DisplayPregnancyQuestion",
            "context" : "Patient",
            "accessLevel" : "Public",
            "expression" : {
               "type" : "And",
               "operand" : [ {
                  "type" : "And",
                  "operand" : [ {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "And",
                        "operand" : [ {
                           "name" : "FemaleAtBirth",
                           "type" : "ExpressionRef"
                        }, {
                           "type" : "Not",
                           "operand" : {
                              "name" : "IsPregnant",
                              "type" : "ExpressionRef"
                           }
                        } ]
                     }, {
                        "type" : "Not",
                        "operand" : {
                           "name" : "HasHadHysterectomy",
                           "type" : "ExpressionRef"
                        }
                     } ]
                  }, {
                     "type" : "And",
                     "operand" : [ {
                        "type" : "GreaterOrEqual",
                        "operand" : [ {
                           "precision" : "Year",
                           "type" : "CalculateAge",
                           "operand" : {
                              "path" : "birthDate.value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Patient",
                                 "type" : "ExpressionRef"
                              }
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "18",
                           "type" : "Literal"
                        } ]
                     }, {
                        "type" : "LessOrEqual",
                        "operand" : [ {
                           "precision" : "Year",
                           "type" : "CalculateAge",
                           "operand" : {
                              "path" : "birthDate.value",
                              "type" : "Property",
                              "source" : {
                                 "name" : "Patient",
                                 "type" : "ExpressionRef"
                              }
                           }
                        }, {
                           "valueType" : "{urn:hl7-org:elm-types:r1}Integer",
                           "value" : "49",
                           "type" : "Literal"
                        } ]
                     } ]
                  } ]
               }, {
                  "type" : "Or",
                  "operand" : [ {
                     "type" : "Or",
                     "operand" : [ {
                        "type" : "Or",
                        "operand" : [ {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "Equivalent",
                              "operand" : [ {
                                 "name" : "ToCode",
                                 "libraryName" : "FHIRHelpers",
                                 "type" : "FunctionRef",
                                 "operand" : [ {
                                    "asType" : "{http://hl7.org/fhir}Coding",
                                    "type" : "As",
                                    "operand" : {
                                       "type" : "SingletonFrom",
                                       "operand" : {
                                          "name" : "CurrentResponse1",
                                          "type" : "ExpressionRef"
                                       }
                                    }
                                 } ]
                              }, {
                                 "name" : "Never",
                                 "type" : "CodeRef"
                              } ]
                           }, {
                              "name" : "AnsweredQuestionsNineAndTen",
                              "type" : "ExpressionRef"
                           } ]
                        }, {
                           "type" : "And",
                           "operand" : [ {
                              "type" : "And",
                              "operand" : [ {
                                 "name" : "AnsweredQuestionsOneThroughThree",
                                 "type" : "ExpressionRef"
                              }, {
                                 "type" : "Not",
                                 "operand" : {
                                    "name" : "DisplayAuditQuestions4to8",
                                    "type" : "ExpressionRef"
                                 }
                              } ]
                           }, {
                              "type" : "Not",
                              "operand" : {
                                 "name" : "DisplayAuditQuestions9and10",
                                 "type" : "ExpressionRef"
                              }
                           } ]
                        } ]
                     }, {
                        "type" : "And",
                        "operand" : [ {
                           "type" : "And",
                           "operand" : [ {
                              "name" : "AnsweredQuestionsOneThroughThree",
                              "type" : "ExpressionRef"
                           }, {
                              "type" : "Not",
                              "operand" : {
                                 "name" : "DisplayAuditQuestions4to8",
                                 "type" : "ExpressionRef"
                              }
                           } ]
                        }, {
                           "name" : "AnsweredQuestionsNineAndTen",
                           "type" : "ExpressionRef"
                        } ]
                     } ]
                  }, {
                     "name" : "AnsweredQuestionsFourThroughTen",
                     "type" : "ExpressionRef"
                  } ]
               } ]
            }
         } ]
      }
   }
}

